<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 1 September 2005), see www.w3.org">
<meta http-equiv="Content-Type" content=
"text/html; charset=us-ascii">
<title>Chapter&nbsp;23.&nbsp;Configuring Power Management
Support</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.68.1">
<link rel="start" href="index.html" title=
"NVIDIA Accelerated Linux Graphics Driver README and Installation Guide">
<link rel="up" href="installationandconfiguration.html" title=
"Part&nbsp;I.&nbsp;Installation and Configuration Instructions">
<link rel="prev" href="procinterface.html" title=
"Chapter&nbsp;22.&nbsp;Using the Proc Filesystem Interface">
<link rel="next" href="xcompositeextension.html" title=
"Chapter&nbsp;24.&nbsp;Using the X Composite Extension">
</head>
<body>
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<th colspan="3" align="center">Chapter&nbsp;23.&nbsp;Configuring
Power Management Support</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href=
"procinterface.html">Prev</a>&nbsp;</td>
<th width="60%" align="center">Part&nbsp;I.&nbsp;Installation and
Configuration Instructions</th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href=
"xcompositeextension.html">Next</a></td>
</tr>
</table>
<hr></div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="powermanagement" id=
"powermanagement"></a>Chapter&nbsp;23.&nbsp;Configuring Power
Management Support</h2>
</div>
</div>
</div>
<p>The NVIDIA driver includes support for both APM- and ACPI- based
power management. The NVIDIA Linux driver supports APM-based
suspend and resume, as well as ACPI standby (S3) and suspend
(S4).</p>
<p>To use APM, your system's BIOS will need to support APM, rather
than ACPI. Many, but not all, of the GeForce2- and GeForce4-based
notebooks include APM support. You can check for APM support via
the procfs interface (check for the existence of /proc/apm) or via
the kernel's boot output:</p>
<pre class="screen">
    % dmesg | grep -i apm
</pre>
<p>a message similar to this indicates APM support:</p>
<pre class="screen">
    apm: BIOS version 1.2 Flags 0x03 (Driver version 1.16)
</pre>
<p>or a message like this indicates no APM support:</p>
<pre class="screen">
    No APM support in Kernel
</pre>
<p>Note: If you are using Linux 2.6 (or a newer Linux kernel) that
was configured with support for both ACPI and APM, the NVIDIA
kernel module will be built with ACPI Power Management support. If
you wish to use APM, you will need to rebuild the Linux kernel
without ACPI support and reinstall the NVIDIA Linux graphics
driver.</p>
<p>Sometimes chipsets lose their AGP configuration during suspend,
and may cause corruption on the bus upon resume. The AGP driver is
required to save and restore relevant register state on such
systems; NVIDIA's NvAGP is notified of power management events and
ensures its configuration is kept intact across suspend/resume
cycles.</p>
<p>Linux 2.4 AGPGART does not support power management, Linux 2.6
or later AGPGART does, but only for a few select chipsets. If you
use either of these two AGP drivers and find your system fails to
resume reliably, you may have more success with the NvAGP
driver.</p>
<p>Disabling AGP support (see <a href="configuringagp.html" title=
"Chapter&nbsp;12.&nbsp;Configuring AGP">Chapter&nbsp;12,
<i>Configuring AGP</i></a> for more details on disabling AGP) will
also work around this problem.</p>
<p>More recent systems are more likely to support ACPI. ACPI is
supported by the NVIDIA graphics driver in Linux 2.6 and newer
kernels. The driver supports ACPI standby (S3) and includes beta
support for ACPI suspend (S4).</p>
<p>If you enable ACPI S4 support via suspend2 patches, you will
need to tweak the Linux kernel such that it dynamically determines
the amount of pages needed by the drivers that will be suspended in
the system. This is done by issuing the following command as
root:</p>
<pre class="screen">
    % echo 0 &gt; /sys/power/suspend2/extra_pages_allowance
</pre>
<p>Older versions of suspend2 may provide a different interface, in
which case the following command needs to be issued as root:</p>
<pre class="screen">
    % echo 0 &gt; /proc/suspend2/extra_pages_allowance
</pre>
<p>The system does NOT need rebooting, and as a matter of fact, the
setting is volatile over reboots. You will need to include the
tweak in your startup scripts. However, failure to perform the
tweak will result in a hang going to sleep. For further information
regarding suspend2 patches, see <a href="http://www.suspend2.net/"
target="_top">http://www.suspend2.net/</a>.</p>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href=
"procinterface.html">Prev</a>&nbsp;</td>
<td width="20%" align="center"><a accesskey="u" href=
"installationandconfiguration.html">Up</a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href=
"xcompositeextension.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">
Chapter&nbsp;22.&nbsp;Using the Proc Filesystem
Interface&nbsp;</td>
<td width="20%" align="center"><a accesskey="h" href=
"index.html">Home</a></td>
<td width="40%" align="right" valign="top">
&nbsp;Chapter&nbsp;24.&nbsp;Using the X Composite Extension</td>
</tr>
</table>
</div>
</body>
</html>
